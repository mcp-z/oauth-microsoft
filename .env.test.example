# Microsoft OAuth Library - Example Test Configuration
# Copy this file to .env.test and fill in your actual credentials

# ============================================================================
# Test Environment
# ============================================================================
NODE_ENV=test

# ============================================================================
# REQUIRED: Microsoft OAuth Client Credentials (Public Client)
# ============================================================================
# Get these from: https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade
# Register as "Mobile and desktop applications" for public client (RFC 8252 loopback)
# PUBLIC CLIENTS: Do NOT set MS_CLIENT_SECRET - Azure rejects secrets from public clients
MS_CLIENT_ID=your-client-id-here
MS_TENANT_ID=common

# ============================================================================
# DCR Test Credentials (Confidential Mode)
# ============================================================================
# DCR uses the SAME client ID but WITH client_secret (confidential mode)
# Azure allows the same app to work as both public (loopback) and confidential (DCR)
# The redirect URI must be registered in Azure Portal under "Web" platform
MS_TEST_DCR_CLIENT_ID=your-client-id-here
MS_TEST_DCR_CLIENT_SECRET=your-client-secret-here
MS_TEST_DCR_TENANT_ID=common
MS_TEST_DCR_REDIRECT_URI=http://localhost:3456/oauth/callback

# ============================================================================
# OAuth Redirect Configuration
# ============================================================================
# Port 3000 is the standard OAuth callback port for all OAuth services
MS_REDIRECT_URI=http://localhost:3000/oauth/callback

# ============================================================================
# Microsoft API Scopes
# ============================================================================
# Microsoft scopes are space-separated
# Include offline_access for refresh tokens and openid/profile/email for user info
# Full Graph URLs recommended for consistency
MS_SCOPE=openid profile email offline_access https://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read https://graph.microsoft.com/Mail.Send

# ============================================================================
# Test Configuration (all have sensible defaults)
# ============================================================================

# Library tests run headless by default (no browser popups)
# HEADLESS=true

# Test encryption key has a default value
# ENCRYPTION_KEY=test-encryption-key-32-characters-long

# Enable manual OAuth tests (requires browser interaction)
# TEST_INCLUDE_MANUAL=true
